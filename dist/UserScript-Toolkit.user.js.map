{"version":3,"sources":["main.js"],"names":["Toolkit","GM","key","is_debug","GM_getValue","self","top","badge","version","GM_info","script","name","description","rightBGColor","ApiKeys","Object","keys","filter","test","dblog","apply","length","concat","by","args","console","groupCollapsed","arg","info","groupEnd","leftText","rightText","endText","options","opt","assign","type","leftBGColor","leftColor","rightColor","apiName","dataName","defaultValue","hasGMApi","Error","window","localStorage","getItem","JSON","parse","sessionStorage","getData","error","message","value","removeData","GM_setValue","stringify","setItem","setData","GM_deleteValue","removeItem","GM_listValues","Array","fill","map","e","i","listData","url","GM_registerMenuCommand","GM_openInTab","open","mark","onName","offName","reload","nowMark","markName","location"],"mappings":"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","file":"UserScript-Toolkit.user.js","sourceRoot":"..","sourcesContent":["/**\r\n * @file DMS UserScripts Toolkit\r\n *\r\n * @author 稻米鼠\r\n * @version 0.0.2\r\n */\r\n/**\r\n * @classdesc GreasyMonkey 脚本工具类\r\n *\r\n * 因脚本中一些基础功能函数需要复用，所以写了这个小的工具库。为对用户安全负责，并符合 GreasyFork 审核规则，代码未作压缩，仅用 Parcel 简单过了一下，一方面是为了用 babel 转码，另一方为后期分文件书写不同类别功能做准备。**这导致代码中注释未能精确对应，使用方法请依照此说明**。\r\n *\r\n * @export\r\n * @class Toolkit\r\n */\r\nexport class Toolkit {\r\n  /**\r\n   * @summary 当前库的版本号\r\n   * @name version\r\n   * @memberof Toolkit\r\n   */\r\n  version = '0.0.2'\r\n  /**\r\n   * @summary 当前是否处于 debug 状态。\r\n   * @description **Debug 模式开启方法：** 手动为此脚本设置一个数据： `is_debug: 1`（在脚本设置页面中）。值可以任意，因为会当作字符串处理，所以不为空即为真。\r\n   *\r\n   * **注意：** 这需要 `GM_getValue` API 的支持\r\n   * @memberof Toolkit\r\n   */\r\n  is_debug = false; // debug 状态\r\n  /**\r\n   * @summary 引入方法\r\n   * @description GreasyFork 发布地址： https://greasyfork.org/zh-CN/scripts/408776\r\n   *\r\n   * 请依照说明，在脚本元数据部分引入对应的最新地址。此工具库仍在更新中，所以请注意保持更新。\r\n   *\r\n   * * 会在控制台输出当前工具库的名称+版本号徽章\r\n   * * 如果在初始化时传入了 `GM_info` 接口，并可用，会输出当前脚本的名称+版本号徽章\r\n   * * 框架中页面不输出，避免重复输出\r\n   * @constructor\r\n   * @param {object} [GM={}] 其中放入会用到的 GreasyMonkey Api 对象\r\n   * @example const DMSTookit = new DMS_UserScripts.Toolkit({GM_info, GM_getValue})\r\n   * @memberof Toolkit\r\n   */\r\n  constructor(GM={}) {\r\n    // 获取需要用到的 API\r\n    for(const key in GM){\r\n      this[key] = GM[key]\r\n    }\r\n    // 设定是否是开发状态\r\n    this.is_debug =\r\n      this.GM_getValue && this.GM_getValue('is_debug', false) ? true : false;\r\n    // 输出版本标记\r\n    if (self != top) return // 框架中页面不输出，避免重复\r\n    this.badge('DMS UserScripts Toolkit', this.version, 'https://script.izyx.xyz')\r\n    if(this.GM_info && this.GM_info.script && this.GM_info.script.name && this.GM_info.script.version){\r\n      this.badge(this.GM_info.script.name, this.GM_info.script.version, this.GM_info.script.description ? this.GM_info.script.description : '', { rightBGColor: '#71baeb' })\r\n    }\r\n    // Debug 时输出获得的 API\r\n    const ApiKeys = Object.keys(this).filter(key=>/^GM_/.test(key))\r\n    this.dblog.apply(\r\n      this,\r\n      ['Constructor - No. of Apis = ' + ApiKeys.length].concat(ApiKeys)\r\n    );\r\n  }\r\n  /* ====== 输出相关 ====== */\r\n  /**\r\n   * @summary 日志输出\r\n   * @description 用 `console.info` 方法输出信息。如多条内容，则以折叠组的形式输出。主要为了便于 debug。\r\n   * @param {string} by 由信息来源标识\r\n   * @param  {...any} args 输出内容，任意多个参数\r\n   * @example\r\n   * DMSTookit.info('Demo', 'Some thing want to print to console.')  // 仅一项需输出内容\r\n   * DMSTookit.info('Demo', 'Some thing want to print to console.', 'And more.')  // 多项输出内容\r\n   * @memberof Toolkit\r\n   */\r\n  info(by, ...args){\r\n    if(args.length > 1){\r\n      console.groupCollapsed(by+'： ')\r\n      for(const arg of args){\r\n        console.info(arg)\r\n      }\r\n      console.groupEnd()\r\n    }else if(args.length === 1){\r\n      console.info(by+'： ', args[0])\r\n    }\r\n  }\r\n  /**\r\n   * @summary Debug 输出，仅开发时输出\r\n   * @description 用 `.info` 方法输出。但仅在 `.is_debug` 为真时输出。这样在发布版本时可不删除这些调试内容。参数同 {@link Toolkit#info}\r\n   * @param {string} by 由信息来源标识\r\n   * @param  {...any} args 输出内容，任意多个参数\r\n   * @memberof Toolkit\r\n   */\r\n  dblog(...args){\r\n    if(this.is_debug){\r\n      this.info.apply(this, args)\r\n    }\r\n  }\r\n  /**\r\n   * @summary 徽章输出\r\n   * @description 类似这种效果 ![](https://img.shields.io/badge/%E5%B7%A6%E4%BE%A7%E6%96%87%E5%AD%97-%E5%8F%B3%E4%BE%A7%E6%96%87%E5%AD%97-%23ffc107?style=flat&labelColor=555555)， 但并不一致。具体可在引用此库，并正确初始化后看控制台输出。其实除了好看也没什么特别的用途。\r\n   * @param {string} leftText 徽章左侧文字\r\n   * @param {string} rightText 徽章右侧文字\r\n   * @param {string} endText 徽章后描述\r\n   * @param {object} options={} 徽章配置项\r\n   * * options.leftBGColor 左侧文字背景色\r\n   * * options.leftColor 左侧文字颜色\r\n   * * options.rightBGColor 右侧文字背景色\r\n   * * options.rightColor 右侧文字颜色\r\n   * @example\r\n   * DMSTookit.badge(\r\n   *   'DMS UserScripts Toolkit',\r\n   *   DMSTookit.version,\r\n   *   'https://greasyfork.org/zh-CN/scripts/408776'\r\n   * )\r\n   * @memberof Toolkit\r\n   */\r\n  badge (leftText, rightText, endText, options={}) {\r\n    const opt = Object.assign({\r\n      type: 'log',\r\n      leftBGColor: '#555555',\r\n      leftColor: '#ededed',\r\n      rightBGColor: '#ffc107',\r\n      rightColor: '#262318',\r\n    }, options)\r\n    console[opt.type](\r\n      '%c'+leftText+'%c'+rightText\r\n      + (endText ? '%c\\n'+endText : ''),\r\n\r\n      'color: '+opt.leftColor+'; '\r\n      +'background-color: '+opt.leftBGColor+'; '\r\n      +'border-radius: 2px 0 0 2px;'\r\n      +'padding: 0 5px',\r\n\r\n      'color: '+opt.rightColor+'; '\r\n      +'background-color: '+opt.rightBGColor+'; '\r\n      +'border-radius: 0 2px 2px 0;'\r\n      +'padding: 0 5px;',\r\n\r\n      '',\r\n    )\r\n  }\r\n  /* ====== 数据相关 ====== */\r\n  /**\r\n   * @summary 【私有】验证是否具有所需的 Api\r\n   * @description 如无法获取此 API，且处于 debug 状态，则在控制台输出提示\r\n   * @param {string} apiName API 的名称\r\n   * @param {string} by='DMS_Toolkit' （可选）调用来源\r\n   * @returns {boolean}\r\n   * @memberof Toolkit\r\n   * @private\r\n   */\r\n  hasGMApi(apiName, by='DMS_Toolkit'){\r\n    if(this[apiName]) return true\r\n    this.dblog(by+' - 未能获取 '+apiName+' 接口', '* 请检查初始化时是否传入对应接口', '* 脚本元数据中是否声明对该接口的使用')\r\n    return false\r\n  }\r\n  /**\r\n   * @summary 获取存储中的数据\r\n   * @description 基础方法，当接口不可用时会直接抛出错误，不建议直接使用。提供如下语法糖：\r\n   * * `getGMData` 将 `type` 指定为 `GM`，然后省略此参数\r\n   * * `getLocalData` 将 `type` 指定为 `local`，然后省略此参数\r\n   * * `getSessionData` 将 `type` 指定为 `session`，然后省略此参数\r\n   * @param {string} type 存储类型，可用值如下：\r\n   * * `GM` 脚本管理器提供的数据存储\r\n   * * `local` localStorage 数据\r\n   * * `session` sessionStorage 数据\r\n   * * `cookie` cookie 数据（暂未提供\r\n   * @param {string} dataName 数据名称\r\n   * @param {any} defaultValue=false 默认值，可省略\r\n   */\r\n  getData (type, dataName, defaultValue=false){\r\n    switch (type) {\r\n      case 'GM':  // 脚本管理器同宫的全局存储\r\n        if( !this.hasGMApi('GM_getValue', 'getData') ) {\r\n          throw new Error(\"This API is not available.\")\r\n        }else{\r\n          return this.GM_getValue(dataName, defaultValue)\r\n        }\r\n        break;\r\n      case 'local': // localStorage\r\n        if( !window.localStorage ) {\r\n          throw new Error(\"This API is not available.\")\r\n        }else{\r\n          if(!localStorage.getItem(dataName)){\r\n            return defaultValue\r\n          }else{\r\n            return JSON.parse(localStorage.getItem(dataName))\r\n          }\r\n        }\r\n        break;\r\n      case 'session': // sessionStorage\r\n        if( !window.sessionStorage ) {\r\n          throw new Error(\"This API is not available.\")\r\n        }else{\r\n          if(!sessionStorage.getItem(dataName)){\r\n            return defaultValue\r\n          }else{\r\n            return JSON.parse(sessionStorage.getItem(dataName))\r\n          }\r\n        }\r\n        break;\r\n      case 'cookie':  // cookies\r\n        this.dblog('getData', 'The method of cookie operation is not yet available.')\r\n        break;\r\n      default:\r\n        this.dblog('getData', 'Probably set the wrong type of get method.')\r\n        throw new Error(\"Probably set the wrong type of get method.\")\r\n        break;\r\n    }\r\n  }\r\n  getGMData (...args){\r\n    try {\r\n      return this.getData.apply(this, ['GM'].concat(args))\r\n    } catch (error) {\r\n      this.dblog('getGMData', error.message)\r\n    }\r\n  }\r\n  getLocalData (...args){\r\n    try {\r\n      return this.getData.apply(this, ['local'].concat(args))\r\n    } catch (error) {\r\n      this.dblog('getLocalData', error.message)\r\n    }\r\n  }\r\n  getSessionData (...args){\r\n    try {\r\n      return this.getData.apply(this, ['session'].concat(args))\r\n    } catch (error) {\r\n      this.dblog('getSessionData', error.message)\r\n    }\r\n  }\r\n  /**\r\n   * @summary 设置存储中的数据\r\n   * @description 基础方法，当接口不可用时会直接抛出错误，不建议直接使用。提供如下语法糖：\r\n   * * `setGMData` 将 `type` 指定为 `GM`，然后省略此参数\r\n   * * `setLocalData` 将 `type` 指定为 `local`，然后省略此参数\r\n   * * `setSessionData` 将 `type` 指定为 `session`，然后省略此参数\r\n   * @param {string} type 存储类型，可用值如下：\r\n   * * `GM` 脚本管理器提供的数据存储\r\n   * * `local` localStorage 数据\r\n   * * `session` sessionStorage 数据\r\n   * * `cookie` cookie 数据（暂未提供\r\n   * @param {string} dataName 数据名称\r\n   * @param {any} value 要写入的值，如不存在则删除该数据\r\n   */\r\n  setData (type, dataName, value){\r\n    // 如果不存在值则删除此数据\r\n    if(typeof(value) === 'undefined'){\r\n      this.removeData(type, dataName)\r\n      this.dblog('setData', 'No value, and removed '+dataName)\r\n      return\r\n    }\r\n    switch (type) {\r\n      case 'GM':  // 脚本管理器同宫的全局存储\r\n        if( !this.hasGMApi('GM_setValue', 'setData') ) {\r\n          throw new Error(\"This API is not available.\")\r\n        }else{\r\n          this.GM_setValue(dataName, JSON.stringify(value))\r\n        }\r\n        break;\r\n      case 'local': // localStorage\r\n        if( !window.localStorage ) {\r\n          throw new Error(\"This API is not available.\")\r\n        }else{\r\n          localStorage.setItem( dataName, JSON.stringify(value) )\r\n        }\r\n        break;\r\n      case 'session': // sessionStorage\r\n        if( !window.sessionStorage ) {\r\n          throw new Error(\"This API is not available.\")\r\n        }else{\r\n          sessionStorage.setItem( dataName, JSON.stringify(value) )\r\n        }\r\n        break;\r\n      case 'cookie':  // cookies\r\n        this.dblog('setData', 'The method of cookie operation is not yet available.')\r\n        break;\r\n      default:\r\n        this.dblog('setData', 'Probably set the wrong type of get method.')\r\n        throw new Error(\"Probably set the wrong type of get method.\")\r\n        break;\r\n    }\r\n  }\r\n  setGMData (...args){\r\n    try {\r\n      this.setData.apply(this, ['GM'].concat(args))\r\n    } catch (error) {\r\n      this.dblog('setGMData', error.message)\r\n    }\r\n  }\r\n  setLocalData (...args){\r\n    try {\r\n      this.setData.apply(this, ['local'].concat(args))\r\n    } catch (error) {\r\n      this.dblog('setLocalData', error.message)\r\n    }\r\n  }\r\n  setSessionData (...args){\r\n    try {\r\n      this.setData.apply(this, ['session'].concat(args))\r\n    } catch (error) {\r\n      this.dblog('setSessionData', error.message)\r\n    }\r\n  }\r\n  /**\r\n   * @summary 移除存储中的数据\r\n   * @description 基础方法，当接口不可用时会直接抛出错误，不建议直接使用。提供如下语法糖：\r\n   * * `removeGMData` 将 `type` 指定为 `GM`，然后省略此参数\r\n   * * `removeLocalData` 将 `type` 指定为 `local`，然后省略此参数\r\n   * * `removeSessionData` 将 `type` 指定为 `session`，然后省略此参数\r\n   * @param {string} type 存储类型，可用值如下：\r\n   * * `GM` 脚本管理器提供的数据存储\r\n   * * `local` localStorage 数据\r\n   * * `session` sessionStorage 数据\r\n   * * `cookie` cookie 数据（暂未提供\r\n   * @param {string} dataName 数据名称\r\n   */\r\n  removeData (type, dataName){\r\n    switch (type) {\r\n      case 'GM':  // 脚本管理器同宫的全局存储\r\n        if( !this.hasGMApi('GM_deleteValue', 'removeData') ) {\r\n          throw new Error(\"This API is not available.\")\r\n        }else{\r\n          this.GM_deleteValue(dataName)\r\n        }\r\n        break;\r\n      case 'local': // localStorage\r\n        if( !window.localStorage ) {\r\n          throw new Error(\"This API is not available.\")\r\n        }else{\r\n          localStorage.removeItem( dataName )\r\n        }\r\n        break;\r\n      case 'session': // sessionStorage\r\n        if( !window.sessionStorage ) {\r\n          throw new Error(\"This API is not available.\")\r\n        }else{\r\n          sessionStorage.removeItem( dataName )\r\n        }\r\n        break;\r\n      case 'cookie':  // cookies\r\n        this.dblog('removeData', 'The method of cookie operation is not yet available.')\r\n        break;\r\n      default:\r\n        this.dblog('removeData', 'Probably set the wrong type of get method.')\r\n        throw new Error(\"Probably set the wrong type of get method.\")\r\n        break;\r\n    }\r\n  }\r\n  removeGMData (...args){\r\n    try {\r\n      this.removeData.apply(this, ['GM'].concat(args))\r\n    } catch (error) {\r\n      this.dblog('removeGMData', error.message)\r\n    }\r\n  }\r\n  removeLocalData (...args){\r\n    try {\r\n      this.removeData.apply(this, ['local'].concat(args))\r\n    } catch (error) {\r\n      this.dblog('removeLocalData', error.message)\r\n    }\r\n  }\r\n  removeSessionData (...args){\r\n    try {\r\n      this.removeData.apply(this, ['session'].concat(args))\r\n    } catch (error) {\r\n      this.dblog('removeSessionData', error.message)\r\n    }\r\n  }\r\n  /**\r\n   * @summary 移除存储中的数据\r\n   * @description 基础方法，当接口不可用时会直接抛出错误，不建议直接使用。提供如下语法糖：\r\n   * * `removeGMData` 将 `type` 指定为 `GM`，然后省略此参数\r\n   * * `removeLocalData` 将 `type` 指定为 `local`，然后省略此参数\r\n   * * `removeSessionData` 将 `type` 指定为 `session`，然后省略此参数\r\n   * @param {string} type 存储类型，可用值如下：\r\n   * * `GM` 脚本管理器提供的数据存储\r\n   * * `local` localStorage 数据\r\n   * * `session` sessionStorage 数据\r\n   * * `cookie` cookie 数据（暂未提供\r\n   * @param {string} dataName 数据名称\r\n   */\r\n  listData (type){\r\n    switch (type) {\r\n      case 'GM':  // 脚本管理器同宫的全局存储\r\n        if( !this.hasGMApi('GM_listValues', 'removeData') ) {\r\n          throw new Error(\"This API is not available.\")\r\n        }else{\r\n          return this.GM_listValues()\r\n        }\r\n        break;\r\n      case 'local': // localStorage\r\n        if( !window.localStorage ) {\r\n          throw new Error(\"This API is not available.\")\r\n        }else{\r\n          return (new Array(localStorage.length)).fill(0).map((e,i)=>localStorage.key(i))\r\n        }\r\n        break;\r\n      case 'session': // sessionStorage\r\n        if( !window.sessionStorage ) {\r\n          throw new Error(\"This API is not available.\")\r\n        }else{\r\n          return (new Array(sessionStorage.length)).fill(0).map((e,i)=>sessionStorage.key(i))\r\n        }\r\n        break;\r\n      case 'cookie':  // cookies\r\n        this.dblog('setData', 'The method of cookie operation is not yet available.')\r\n        break;\r\n      default:\r\n        this.dblog('listData', 'Probably set the wrong type of get method.')\r\n        throw new Error(\"Probably set the wrong type of get method.\")\r\n        break;\r\n    }\r\n  }\r\n  listGMData (){\r\n    try {\r\n      return this.listData.apply(this, ['GM'])\r\n    } catch (error) {\r\n      this.dblog('listGMData', error.message)\r\n    }\r\n  }\r\n  listLocalData (){\r\n    try {\r\n      return this.listData.apply(this, ['local'])\r\n    } catch (error) {\r\n      this.dblog('listLocalData', error.message)\r\n    }\r\n  }\r\n  listSessionData (){\r\n    try {\r\n      return this.listData.apply(this, ['session'])\r\n    } catch (error) {\r\n      this.dblog('listSessionData', error.message)\r\n    }\r\n  }\r\n\r\n  /* ====== 菜单相关 ====== */\r\n  /**\r\n   * @summary 注册一个链接菜单\r\n   * @description 需要如下 API：\r\n   * * `GM_registerMenuCommand` 【必须】否则无法注册脚本菜单\r\n   * * `GM_openInTab` 【可选】可以更稳定的在新窗口打开链接\r\n   * @param {string} name 菜单的名称\r\n   * @param {url} url 链接地址，含协议部分（`http://`，`https://`），否则可能按相对地址处理\r\n   * @example DMSTookit.menuLink('更多脚本', 'https://script.izyx.xyz/')\r\n   * @memberof Toolkit\r\n   */\r\n  menuLink (name, url){\r\n    if(!this.hasGMApi('GM_registerMenuCommand', 'menuLink')) return\r\n    GM_registerMenuCommand(name, ()=>{\r\n      if(this.hasGMApi('GM_openInTab', 'menuLink')){\r\n        GM_openInTab(url)\r\n        return\r\n      }\r\n      window.open(url, '_blank')\r\n    })\r\n  }\r\n  /**\r\n   * @summary 注册一个切换菜单\r\n   * @description 因为不同管理器下菜单的反注册方式不太一样，所以最稳妥的方法是切换后刷新页面。如果不刷新页面，会用两种方法尝试反注册菜单。需要如下 API：\r\n     * * `GM_registerMenuCommand` 【必须】否则无法注册脚本菜单\r\n   * @param {string} mark 标记名称\r\n   * @param {string} onName 启用状态菜单文字\r\n   * @param {string} offName 禁用状态菜单文字\r\n   * @param {boolean} reload 是否需要刷新页面，默认为是\r\n   * @returns 当前启用/禁用状态\r\n   * @memberof Toolkit\r\n   */\r\n  toggleMenu (mark, onName, offName, reload=true){\r\n    if(!this.hasGMApi('GM_registerMenuCommand', 'toggleMenu')) return\r\n    const nowMark = mark.key\r\n    if(localStorage.getItem(markName)){\r\n      // 【Menu】菜单启用状态\r\n      GM_registerMenuCommand(onName, ()=>{\r\n        localStorage.removeItem(markName)\r\n        if(reload) window.location.reload(1)\r\n      })\r\n      return true\r\n    }\r\n    // 【Menu】菜单禁用状态\r\n    GM_registerMenuCommand(offName, ()=>{\r\n      localStorage.setItem(markName, true)\r\n      if(reload) window.location.reload(1)\r\n    })\r\n    return false\r\n  }\r\n}\r\n"]}